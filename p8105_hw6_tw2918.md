p8105_hw6_tw2918
================
2023-11-20

## Probelm 1

**Import and Clean Dataset**

- update the victim’s first and last name to proper case
- replace `unknown` to missing value `NA`
- update `victim_age` to numeric variable
- create new variable `city_state` and `case_sovled`
- filter out four `city_state` values
- filter and only keep observations if `victim_race` is white or black.

``` r
homicide_df = read_csv("./data/homicide_data.csv", show_col_types = FALSE) |>
  janitor::clean_names()|>
  mutate (
    victim_last = str_to_title(victim_last),
    victim_first = str_to_title(victim_first),
    across(c(uid, victim_last, victim_first, victim_race, victim_age, victim_sex, city, state, disposition), ~na_if(., "Unknown")),
    victim_age = as.numeric(victim_age),
    city_state = paste(city, state, sep = ", "),
    case_resolved = ifelse(grepl("Closed", disposition, ignore.case = TRUE), "1", "0")
    )|>
  filter(
    !city_state %in% c("Tulsa, AL", "Dallas, TX", "Phoenix, AZ", "Kansas City, MO" ),
    victim_race == "White" | victim_race == "Black"
    )

print(homicide_df)
```

    ## # A tibble: 39,693 × 14
    ##    uid        reported_date victim_last  victim_first victim_race victim_age
    ##    <chr>              <dbl> <chr>        <chr>        <chr>            <dbl>
    ##  1 Alb-000003      20100601 Satterfield  Viviana      White               15
    ##  2 Alb-000005      20100102 Mula         Vivian       White               72
    ##  3 Alb-000006      20100126 Book         Geraldine    White               91
    ##  4 Alb-000009      20100130 Martin-Leyva Gustavo      White               56
    ##  5 Alb-000012      20100218 Lujan        Kevin        White               NA
    ##  6 Alb-000016      20100308 Gray         Stefania     White               43
    ##  7 Alb-000018      20100323 David        Larry        White               52
    ##  8 Alb-000019      20100402 Brito        Elizabeth    White               22
    ##  9 Alb-000021      20100423 King         Tevion       Black               15
    ## 10 Alb-000022      20100423 Boykin       Cedric       Black               25
    ## # ℹ 39,683 more rows
    ## # ℹ 8 more variables: victim_sex <chr>, city <chr>, state <chr>, lat <dbl>,
    ## #   lon <dbl>, disposition <chr>, city_state <chr>, case_resolved <chr>

**logistic regression on city of Balitmore, MD**

For the city of `Baltimore, MD`, use the `glm` function to fit a
logistic regression with `resolved` vs `unresolved` as the outcome and
victim age, sex and race as predictors. Save the output of `glm` as an
`R object`;

``` r
fit_logistic = homicide_df |>
  filter(city_state == "Baltimore, MD")|>
  mutate(case_resolved = as.numeric(case_resolved))|>
  glm(case_resolved ~ victim_age + victim_sex + victim_race,data = _, family = binomial())

print(fit_logistic)
```

    ## 
    ## Call:  glm(formula = case_resolved ~ victim_age + victim_sex + victim_race, 
    ##     family = binomial(), data = mutate(filter(homicide_df, city_state == 
    ##         "Baltimore, MD"), case_resolved = as.numeric(case_resolved)))
    ## 
    ## Coefficients:
    ##      (Intercept)        victim_age    victim_sexMale  victim_raceWhite  
    ##         0.663792         -0.005205         -1.036564          0.899714  
    ## 
    ## Degrees of Freedom: 2752 Total (i.e. Null);  2749 Residual
    ## Null Deviance:       3717 
    ## Residual Deviance: 3619  AIC: 3627

apply the `broom::tidy` to this object; and obtain the estimate and
confidence interval of the adjusted odds ratio for solving homicides
comparing male victims to female victims keeping all other variables
fixed.

``` r
fit_logistic|>
  broom::tidy()|>
  filter(term == "victim_sexMale")|>
  mutate(OR = exp(estimate),
         ci_lower = exp(estimate - (1.96 * std.error)),
         ci_upper = exp(estimate + (1.96 * std.error))
      )|>
  select(term, OR, ci_lower, ci_upper)|>
  knitr::kable()
```

| term           |        OR | ci_lower |  ci_upper |
|:---------------|----------:|---------:|----------:|
| victim_sexMale | 0.3546711 | 0.268143 | 0.4691213 |
